<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>ğŸ“•D2024_7_25 | Hrein's Blog</title><meta name="author" content="Hrein"><meta name="copyright" content="Hrein"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Promiseæƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä½é¡¶å°–æ­Œæ‰‹ï¼Œç²‰ä¸æ²¡æ—¥æ²¡å¤œåœ°è¯¢é—®ä½ ä¸‹é¦–æ­Œä»€ä¹ˆæ—¶å€™å‘ã€‚ ä¸ºäº†ä»ä¸­è§£æ”¾ï¼Œä½ æ‰¿è¯ºï¼ˆpromiseï¼‰ä¼šåœ¨å•æ›²å‘å¸ƒçš„ç¬¬ä¸€æ—¶é—´å‘ç»™ä»–ä»¬ã€‚ä½ ç»™äº†ç²‰ä¸ä»¬ä¸€ä¸ªåˆ—è¡¨ã€‚ä»–ä»¬å¯ä»¥åœ¨ä¸Šé¢å¡«å†™ä»–ä»¬çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œä»¥ä¾¿å½“æ­Œæ›²å‘å¸ƒåï¼Œè®©æ‰€æœ‰è®¢é˜…äº†çš„äººèƒ½å¤Ÿç«‹å³æ”¶åˆ°ã€‚å³ä¾¿é‡åˆ°ä¸æµ‹ï¼Œä¾‹å¦‚å½•éŸ³å®¤å‘ç”Ÿäº†ç«ç¾ï¼Œä»¥è‡´ä½ æ— æ³•å‘å¸ƒæ–°æ­Œï¼Œä»–ä»¬ä¹Ÿèƒ½åŠæ—¶æ”¶åˆ°ç›¸å…³é€šçŸ¥ã€‚ æ¯ä¸ªäººéƒ½å¾ˆå¼€å¿ƒï¼šä½ ä¸ä¼šè¢«ä»»ä½•äººå‚¬ä¿ƒï¼Œç²‰ä¸ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒé”™è¿‡">
<meta property="og:type" content="article">
<meta property="og:title" content="ğŸ“•D2024_7_25">
<meta property="og:url" content="https://qhiqiefnqe-f.github.io/2024/07/25/Diary/2024_7_25/index.html">
<meta property="og:site_name" content="Hrein&#39;s Blog">
<meta property="og:description" content="Promiseæƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä½é¡¶å°–æ­Œæ‰‹ï¼Œç²‰ä¸æ²¡æ—¥æ²¡å¤œåœ°è¯¢é—®ä½ ä¸‹é¦–æ­Œä»€ä¹ˆæ—¶å€™å‘ã€‚ ä¸ºäº†ä»ä¸­è§£æ”¾ï¼Œä½ æ‰¿è¯ºï¼ˆpromiseï¼‰ä¼šåœ¨å•æ›²å‘å¸ƒçš„ç¬¬ä¸€æ—¶é—´å‘ç»™ä»–ä»¬ã€‚ä½ ç»™äº†ç²‰ä¸ä»¬ä¸€ä¸ªåˆ—è¡¨ã€‚ä»–ä»¬å¯ä»¥åœ¨ä¸Šé¢å¡«å†™ä»–ä»¬çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œä»¥ä¾¿å½“æ­Œæ›²å‘å¸ƒåï¼Œè®©æ‰€æœ‰è®¢é˜…äº†çš„äººèƒ½å¤Ÿç«‹å³æ”¶åˆ°ã€‚å³ä¾¿é‡åˆ°ä¸æµ‹ï¼Œä¾‹å¦‚å½•éŸ³å®¤å‘ç”Ÿäº†ç«ç¾ï¼Œä»¥è‡´ä½ æ— æ³•å‘å¸ƒæ–°æ­Œï¼Œä»–ä»¬ä¹Ÿèƒ½åŠæ—¶æ”¶åˆ°ç›¸å…³é€šçŸ¥ã€‚ æ¯ä¸ªäººéƒ½å¾ˆå¼€å¿ƒï¼šä½ ä¸ä¼šè¢«ä»»ä½•äººå‚¬ä¿ƒï¼Œç²‰ä¸ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒé”™è¿‡">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qhiqiefnqe-f.github.io/assets/Hrein.jpg">
<meta property="article:published_time" content="2024-07-25T11:40:19.000Z">
<meta property="article:modified_time" content="2024-09-15T14:04:17.567Z">
<meta property="article:author" content="Hrein">
<meta property="article:tag" content="frontend">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qhiqiefnqe-f.github.io/assets/Hrein.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://qhiqiefnqe-f.github.io/2024/07/25/Diary/2024_7_25/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ğŸ“•D2024_7_25',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-15 22:04:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/assets/Hrein.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/assets/nanjiluo.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Hrein's Blog"><span class="site-name">Hrein's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ğŸ“•D2024_7_25</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-07-25T11:40:19.000Z" title="å‘è¡¨äº 2024-07-25 19:40:19">2024-07-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-09-15T14:04:17.567Z" title="æ›´æ–°äº 2024-09-15 22:04:17">2024-09-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Diary/">Diary</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ğŸ“•D2024_7_25"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä½é¡¶å°–æ­Œæ‰‹ï¼Œç²‰ä¸æ²¡æ—¥æ²¡å¤œåœ°è¯¢é—®ä½ ä¸‹é¦–æ­Œä»€ä¹ˆæ—¶å€™å‘ã€‚</p>
<p>ä¸ºäº†ä»ä¸­è§£æ”¾ï¼Œä½ æ‰¿è¯ºï¼ˆpromiseï¼‰ä¼šåœ¨å•æ›²å‘å¸ƒçš„ç¬¬ä¸€æ—¶é—´å‘ç»™ä»–ä»¬ã€‚ä½ ç»™äº†ç²‰ä¸ä»¬ä¸€ä¸ªåˆ—è¡¨ã€‚ä»–ä»¬å¯ä»¥åœ¨ä¸Šé¢å¡«å†™ä»–ä»¬çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œä»¥ä¾¿å½“æ­Œæ›²å‘å¸ƒåï¼Œè®©æ‰€æœ‰è®¢é˜…äº†çš„äººèƒ½å¤Ÿç«‹å³æ”¶åˆ°ã€‚å³ä¾¿é‡åˆ°ä¸æµ‹ï¼Œä¾‹å¦‚å½•éŸ³å®¤å‘ç”Ÿäº†ç«ç¾ï¼Œä»¥è‡´ä½ æ— æ³•å‘å¸ƒæ–°æ­Œï¼Œä»–ä»¬ä¹Ÿèƒ½åŠæ—¶æ”¶åˆ°ç›¸å…³é€šçŸ¥ã€‚</p>
<p>æ¯ä¸ªäººéƒ½å¾ˆå¼€å¿ƒï¼šä½ ä¸ä¼šè¢«ä»»ä½•äººå‚¬ä¿ƒï¼Œç²‰ä¸ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒé”™è¿‡æ­Œæ›²å‘è¡Œã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬åœ¨ç¼–ç¨‹ä¸­ç»å¸¸é‡åˆ°çš„äº‹å„¿ä¸çœŸå®ç”Ÿæ´»çš„ç±»æ¯”ï¼š</p>
<ol>
<li>â€œç”Ÿäº§è€…ä»£ç ï¼ˆproducing codeï¼‰â€ä¼šåšä¸€äº›äº‹å„¿ï¼Œå¹¶ä¸”ä¼šéœ€è¦ä¸€äº›æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç½‘ç»œåŠ è½½æ•°æ®çš„ä»£ç ã€‚å®ƒå°±åƒä¸€ä½â€œæ­Œæ‰‹â€ã€‚</li>
<li>â€œæ¶ˆè´¹è€…ä»£ç ï¼ˆconsuming codeï¼‰â€æƒ³è¦åœ¨â€œç”Ÿäº§è€…ä»£ç â€å®Œæˆå·¥ä½œçš„ç¬¬ä¸€æ—¶é—´å°±èƒ½è·å¾—å…¶å·¥ä½œæˆæœã€‚è®¸å¤šå‡½æ•°å¯èƒ½éƒ½éœ€è¦è¿™ä¸ªç»“æœã€‚è¿™äº›å°±æ˜¯â€œç²‰ä¸â€ã€‚</li>
<li><strong>Promise</strong> æ˜¯å°†â€œç”Ÿäº§è€…ä»£ç â€å’Œâ€œæ¶ˆè´¹è€…ä»£ç â€è¿æ¥åœ¨ä¸€èµ·çš„ä¸€ä¸ªç‰¹æ®Šçš„ JavaScript å¯¹è±¡ã€‚ç”¨æˆ‘ä»¬çš„ç±»æ¯”æ¥è¯´ï¼šè¿™å°±æ˜¯å°±åƒæ˜¯â€œè®¢é˜…åˆ—è¡¨â€ã€‚â€œç”Ÿäº§è€…ä»£ç â€èŠ±è´¹å®ƒæ‰€éœ€çš„ä»»æ„é•¿åº¦æ—¶é—´æ¥äº§å‡ºæ‰€æ‰¿è¯ºçš„ç»“æœï¼Œè€Œ â€œpromiseâ€ å°†åœ¨å®ƒï¼ˆè¯‘æ³¨ï¼šæŒ‡çš„æ˜¯â€œç”Ÿäº§è€…ä»£ç â€ï¼Œä¹Ÿå°±æ˜¯ä¸‹æ–‡æ‰€è¯´çš„ executorï¼‰å‡†å¤‡å¥½æ—¶ï¼Œå°†ç»“æœå‘æ‰€æœ‰è®¢é˜…äº†çš„ä»£ç å¼€æ”¾ã€‚</li>
</ol>
<p>è¿™ç§ç±»æ¯”å¹¶ä¸ååˆ†å‡†ç¡®ï¼Œå› ä¸º JavaScipt çš„ promise æ¯”ç®€å•çš„è®¢é˜…åˆ—è¡¨æ›´åŠ å¤æ‚ï¼šå®ƒä»¬è¿˜æ‹¥æœ‰å…¶ä»–çš„åŠŸèƒ½å’Œå±€é™æ€§ã€‚ä½†ä»¥æ­¤å¼€å§‹æŒºå¥½çš„ã€‚</p>
<p>Promise å¯¹è±¡çš„æ„é€ å™¨ï¼ˆconstructorï¼‰è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// executorï¼ˆç”Ÿäº§è€…ä»£ç ï¼Œâ€œæ­Œæ‰‹â€ï¼‰</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¼ é€’ç»™ <code>new Promise</code> çš„å‡½æ•°è¢«ç§°ä¸º <strong>executor</strong>ã€‚å½“ <code>new Promise</code> è¢«åˆ›å»ºï¼Œexecutor ä¼šè‡ªåŠ¨è¿è¡Œã€‚å®ƒåŒ…å«æœ€ç»ˆåº”äº§å‡ºç»“æœçš„ç”Ÿäº§è€…ä»£ç ã€‚æŒ‰ç…§ä¸Šé¢çš„ç±»æ¯”ï¼šexecutor å°±æ˜¯â€œæ­Œæ‰‹â€ã€‚</p>
<p>å®ƒçš„å‚æ•° <code>resolve</code> å’Œ <code>reject</code> æ˜¯ç”± JavaScript è‡ªèº«æä¾›çš„å›è°ƒã€‚æˆ‘ä»¬çš„ä»£ç ä»…åœ¨ executor çš„å†…éƒ¨ã€‚</p>
<p>å½“ executor è·å¾—äº†ç»“æœï¼Œæ— è®ºæ˜¯æ—©è¿˜æ˜¯æ™šéƒ½æ²¡å…³ç³»ï¼Œå®ƒåº”è¯¥è°ƒç”¨ä»¥ä¸‹å›è°ƒä¹‹ä¸€ï¼š</p>
<ul>
<li><code>resolve(value)</code> â€”â€” å¦‚æœä»»åŠ¡æˆåŠŸå®Œæˆå¹¶å¸¦æœ‰ç»“æœ <code>value</code>ã€‚</li>
<li><code>reject(error)</code> â€”â€” å¦‚æœå‡ºç°äº† errorï¼Œ<code>error</code> å³ä¸º error å¯¹è±¡ã€‚</li>
</ul>
<p>æ‰€ä»¥æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šexecutor ä¼šè‡ªåŠ¨è¿è¡Œå¹¶å°è¯•æ‰§è¡Œä¸€é¡¹å·¥ä½œã€‚å°è¯•ç»“æŸåï¼Œå¦‚æœæˆåŠŸåˆ™è°ƒç”¨ <code>resolve</code>ï¼Œå¦‚æœå‡ºç° error åˆ™è°ƒç”¨ <code>reject</code>ã€‚</p>
<p>ç”± <code>new Promise</code> æ„é€ å™¨è¿”å›çš„ <code>promise</code> å¯¹è±¡å…·æœ‰ä»¥ä¸‹å†…éƒ¨å±æ€§ï¼š</p>
<ul>
<li><code>state</code> â€”â€” æœ€åˆæ˜¯ <code>&quot;pending&quot;</code>ï¼Œç„¶ååœ¨ <code>resolve</code> è¢«è°ƒç”¨æ—¶å˜ä¸º <code>&quot;fulfilled&quot;</code>ï¼Œæˆ–è€…åœ¨ <code>reject</code> è¢«è°ƒç”¨æ—¶å˜ä¸º <code>&quot;rejected&quot;</code>ã€‚</li>
<li><code>result</code> â€”â€” æœ€åˆæ˜¯ <code>undefined</code>ï¼Œç„¶ååœ¨ <code>resolve(value)</code> è¢«è°ƒç”¨æ—¶å˜ä¸º <code>value</code>ï¼Œæˆ–è€…åœ¨ <code>reject(error)</code> è¢«è°ƒç”¨æ—¶å˜ä¸º <code>error</code>ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œexecutor æœ€ç»ˆå°† <code>promise</code> ç§»è‡³ä»¥ä¸‹çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<p><img src="/promise-resolve-reject.svg"></p>
<p>ç¨åæˆ‘ä»¬å°†çœ‹åˆ°â€œç²‰ä¸â€å¦‚ä½•è®¢é˜…è¿™äº›æ›´æ”¹ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª promise æ„é€ å™¨å’Œä¸€ä¸ªç®€å•çš„ executor å‡½æ•°ï¼Œè¯¥ executor å‡½æ•°å…·æœ‰åŒ…å«æ—¶é—´ï¼ˆå³ <code>setTimeout</code>ï¼‰çš„â€œç”Ÿäº§è€…ä»£ç â€ï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// å½“ promise è¢«æ„é€ å®Œæˆæ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œæ­¤å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1 ç§’åå‘å‡ºå·¥ä½œå·²ç»è¢«å®Œæˆçš„ä¿¡å·ï¼Œå¹¶å¸¦æœ‰ç»“æœ &quot;done&quot;</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> *!*<span class="title function_">resolve</span>(<span class="string">&quot;done&quot;</span>)*/!*, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä»¶äº‹å„¿ï¼š</p>
<ol>
<li><p>executor è¢«è‡ªåŠ¨ä¸”ç«‹å³è°ƒç”¨ï¼ˆé€šè¿‡ <code>new Promise</code>ï¼‰ã€‚</p>
</li>
<li><p>executor æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>resolve</code> å’Œ <code>reject</code>ã€‚è¿™äº›å‡½æ•°ç”± JavaScript å¼•æ“é¢„å…ˆå®šä¹‰ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºå®ƒä»¬ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨å‡†å¤‡å¥½ï¼ˆè¯‘æ³¨ï¼šæŒ‡çš„æ˜¯ executor å‡†å¤‡å¥½ï¼‰æ—¶è°ƒç”¨å…¶ä¸­ä¹‹ä¸€å³å¯ã€‚</p>
<p> ç»è¿‡ 1 ç§’çš„â€œå¤„ç†â€åï¼Œexecutor è°ƒç”¨ <code>resolve(&quot;done&quot;)</code> æ¥äº§ç”Ÿç»“æœã€‚è¿™å°†æ”¹å˜ <code>promise</code> å¯¹è±¡çš„çŠ¶æ€ï¼š</p>
<p> <img src="/promise-resolve-1.svg"></p>
</li>
</ol>
<p>è¿™æ˜¯ä¸€ä¸ªæˆåŠŸå®Œæˆä»»åŠ¡çš„ä¾‹å­ï¼Œä¸€ä¸ªâ€œæˆåŠŸå®ç°äº†çš„è¯ºè¨€â€ã€‚</p>
<p>ä¸‹é¢åˆ™æ˜¯ä¸€ä¸ª executor ä»¥ error æ‹’ç» promise çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// 1 ç§’åå‘å‡ºå·¥ä½œå·²ç»è¢«å®Œæˆçš„ä¿¡å·ï¼Œå¹¶å¸¦æœ‰ error</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> *!*<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Whoops!&quot;</span>))*/!*, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¯¹ <code>reject(...)</code> çš„è°ƒç”¨å°† promise å¯¹è±¡çš„çŠ¶æ€ç§»è‡³ <code>&quot;rejected&quot;</code>ï¼š</p>
<p><img src="/promise-reject-1.svg"></p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œexecutor åº”è¯¥æ‰§è¡Œä¸€é¡¹å·¥ä½œï¼ˆé€šå¸¸æ˜¯éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´çš„äº‹å„¿ï¼‰ï¼Œç„¶åè°ƒç”¨ <code>resolve</code> æˆ– <code>reject</code> æ¥æ”¹å˜å¯¹åº”çš„ promise å¯¹è±¡çš„çŠ¶æ€ã€‚</p>
<p>ä¸æœ€åˆçš„ â€œpendingâ€ promise ç›¸åï¼Œä¸€ä¸ª resolved æˆ– rejected çš„ promise éƒ½ä¼šè¢«ç§°ä¸º â€œsettledâ€ã€‚</p>
<figure class="highlight plaintext"><figcaption><span>header</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">executor åªèƒ½è°ƒç”¨ä¸€ä¸ª `resolve` æˆ–ä¸€ä¸ª `reject`ã€‚ä»»ä½•çŠ¶æ€çš„æ›´æ”¹éƒ½æ˜¯æœ€ç»ˆçš„ã€‚</span><br><span class="line"></span><br><span class="line">æ‰€æœ‰å…¶ä»–çš„å†å¯¹ `resolve` å’Œ `reject` çš„è°ƒç”¨éƒ½ä¼šè¢«å¿½ç•¥ï¼š</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">let promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">*!*</span><br><span class="line">  resolve(&quot;done&quot;);</span><br><span class="line">*/!*</span><br><span class="line"></span><br><span class="line">  reject(new Error(&quot;â€¦&quot;)); // è¢«å¿½ç•¥</span><br><span class="line">  setTimeout(() =&gt; resolve(&quot;â€¦&quot;)); // è¢«å¿½ç•¥</span><br><span class="line">&#125;);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">å…³é”®å°±åœ¨äºï¼Œä¸€ä¸ªç”± executor å®Œæˆçš„å·¥ä½œåªèƒ½æœ‰ä¸€ä¸ªç»“æœæˆ–ä¸€ä¸ª errorã€‚</span><br><span class="line"></span><br><span class="line">å¹¶ä¸”ï¼Œ`resolve/reject` åªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼ˆæˆ–ä¸åŒ…å«ä»»ä½•å‚æ•°ï¼‰ï¼Œå¹¶ä¸”å°†å¿½ç•¥é¢å¤–çš„å‚æ•°ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><figcaption><span>header</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä»€ä¹ˆä¸œè¥¿å‡ºäº†é—®é¢˜ï¼Œexecutor åº”è¯¥è°ƒç”¨ `reject`ã€‚è¿™å¯ä»¥ä½¿ç”¨ä»»ä½•ç±»å‹çš„å‚æ•°æ¥å®Œæˆï¼ˆå°±åƒ `resolve` ä¸€æ ·ï¼‰ã€‚ä½†å»ºè®®ä½¿ç”¨ `Error` å¯¹è±¡ï¼ˆæˆ–ç»§æ‰¿è‡ª `Error` çš„å¯¹è±¡ï¼‰ã€‚è¿™æ ·åšçš„ç†ç”±å¾ˆå¿«å°±ä¼šæ˜¾è€Œæ˜“è§ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><figcaption><span>header</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å®é™…ä¸Šï¼Œexecutor é€šå¸¸æ˜¯å¼‚æ­¥æ‰§è¡ŒæŸäº›æ“ä½œï¼Œå¹¶åœ¨ä¸€æ®µæ—¶é—´åè°ƒç”¨ `resolve/reject`ï¼Œä½†è¿™ä¸æ˜¯å¿…é¡»çš„ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ç«‹å³è°ƒç”¨ `resolve` æˆ– `reject`ï¼Œå°±åƒè¿™æ ·ï¼š</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">let promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">  // ä¸èŠ±æ—¶é—´å»åšè¿™é¡¹å·¥ä½œ</span><br><span class="line">  resolve(123); // ç«‹å³ç»™å‡ºç»“æœï¼š123</span><br><span class="line">&#125;);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬å¼€å§‹åšä¸€ä¸ªä»»åŠ¡ï¼Œéšåå‘ç°ä¸€åˆ‡éƒ½å·²ç»å®Œæˆå¹¶å·²è¢«ç¼“å­˜æ—¶ï¼Œå¯èƒ½å°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</span><br><span class="line"></span><br><span class="line">è¿™æŒºå¥½ã€‚æˆ‘ä»¬ç«‹å³å°±æœ‰äº†ä¸€ä¸ª resolved çš„ promiseã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><figcaption><span>header</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Promise å¯¹è±¡çš„ `state` å’Œ `result` å±æ€§éƒ½æ˜¯å†…éƒ¨çš„ã€‚æˆ‘ä»¬æ— æ³•ç›´æ¥è®¿é—®å®ƒä»¬ã€‚ä½†æˆ‘ä»¬å¯ä»¥å¯¹å®ƒä»¬ä½¿ç”¨ `.then`/`.catch`/`.finally` æ–¹æ³•ã€‚æˆ‘ä»¬åœ¨ä¸‹é¢å¯¹è¿™äº›æ–¹æ³•è¿›è¡Œäº†æè¿°ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="æ¶ˆè´¹è€…ï¼šthenï¼Œcatch"><a href="#æ¶ˆè´¹è€…ï¼šthenï¼Œcatch" class="headerlink" title="æ¶ˆè´¹è€…ï¼šthenï¼Œcatch"></a>æ¶ˆè´¹è€…ï¼šthenï¼Œcatch</h2><p>Promise å¯¹è±¡å……å½“çš„æ˜¯ executorï¼ˆâ€œç”Ÿäº§è€…ä»£ç â€æˆ–â€œæ­Œæ‰‹â€ï¼‰å’Œæ¶ˆè´¹å‡½æ•°ï¼ˆâ€œç²‰ä¸â€ï¼‰ä¹‹é—´çš„è¿æ¥ï¼Œåè€…å°†æ¥æ”¶ç»“æœæˆ– errorã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>.then</code> å’Œ <code>.catch</code> æ–¹æ³•æ³¨å†Œæ¶ˆè´¹å‡½æ•°ã€‚</p>
<h3 id="then"><a href="#then" class="headerlink" title="then"></a>then</h3><p>æœ€é‡è¦æœ€åŸºç¡€çš„ä¸€ä¸ªå°±æ˜¯ <code>.then</code>ã€‚</p>
<p>è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">result</span>) &#123; *!*<span class="comment">/* handle a successful result */</span>*/!* &#125;,</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">error</span>) &#123; *!*<span class="comment">/* handle an error */</span>*/!* &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>.then</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨ promise resolved ä¸”æ¥æ”¶åˆ°ç»“æœåæ‰§è¡Œã€‚</p>
<p><code>.then</code> çš„ç¬¬äºŒä¸ªå‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨ promise rejected ä¸”æ¥æ”¶åˆ° error ä¿¡æ¯åæ‰§è¡Œã€‚</p>
<p>ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯å¯¹æˆåŠŸ resolved çš„ promise åšå‡ºçš„ååº”ï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;done!&quot;</span>), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// resolve è¿è¡Œ .then ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">*!*</span><br><span class="line">  <span class="function"><span class="params">result</span> =&gt;</span> <span class="title function_">alert</span>(result), <span class="comment">// 1 ç§’åæ˜¾ç¤º &quot;done!&quot;</span></span><br><span class="line">*/!*</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> <span class="title function_">alert</span>(error) <span class="comment">// ä¸è¿è¡Œ</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå‡½æ•°è¢«è¿è¡Œäº†ã€‚</p>
<p>åœ¨ reject çš„æƒ…å†µä¸‹ï¼Œè¿è¡Œç¬¬äºŒä¸ªï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Whoops!&quot;</span>)), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// reject è¿è¡Œ .then ä¸­çš„ç¬¬äºŒä¸ªå‡½æ•°</span></span><br><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">result</span> =&gt;</span> <span class="title function_">alert</span>(result), <span class="comment">// ä¸è¿è¡Œ</span></span><br><span class="line">*!*</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> <span class="title function_">alert</span>(error) <span class="comment">// 1 ç§’åæ˜¾ç¤º &quot;Error: Whoops!&quot;</span></span><br><span class="line">*/!*</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬åªå¯¹æˆåŠŸå®Œæˆçš„æƒ…å†µæ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åªä¸º <code>.then</code> æä¾›ä¸€ä¸ªå‡½æ•°å‚æ•°ï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;done!&quot;</span>), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">*!*</span><br><span class="line">promise.<span class="title function_">then</span>(alert); <span class="comment">// 1 ç§’åæ˜¾ç¤º &quot;done!&quot;</span></span><br><span class="line">*/!*</span><br></pre></td></tr></table></figure>

<h3 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h3><p>å¦‚æœæˆ‘ä»¬åªå¯¹ error æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>null</code> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼š<code>.then(null, errorHandlingFunction)</code>ã€‚æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.catch(errorHandlingFunction)</code>ï¼Œå…¶å®æ˜¯ä¸€æ ·çš„ï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Whoops!&quot;</span>)), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">*!*</span><br><span class="line"><span class="comment">// .catch(f) ä¸ promise.then(null, f) ä¸€æ ·</span></span><br><span class="line">promise.<span class="title function_">catch</span>(alert); <span class="comment">// 1 ç§’åæ˜¾ç¤º &quot;Error: Whoops!&quot;</span></span><br><span class="line">*/!*</span><br></pre></td></tr></table></figure>

<p><code>.catch(f)</code> è°ƒç”¨æ˜¯ <code>.then(null, f)</code> çš„å®Œå…¨çš„æ¨¡æ‹Ÿï¼Œå®ƒåªæ˜¯ä¸€ä¸ªç®€å†™å½¢å¼ã€‚</p>
<h2 id="æ¸…ç†ï¼šfinally"><a href="#æ¸…ç†ï¼šfinally" class="headerlink" title="æ¸…ç†ï¼šfinally"></a>æ¸…ç†ï¼šfinally</h2><p>å°±åƒå¸¸è§„ <code>try &#123;...&#125; catch &#123;...&#125;</code> ä¸­çš„ <code>finally</code> å­å¥ä¸€æ ·ï¼Œpromise ä¸­ä¹Ÿæœ‰ <code>finally</code>ã€‚</p>
<p>è°ƒç”¨ <code>.finally(f)</code> ç±»ä¼¼äº <code>.then(f, f)</code>ï¼Œå› ä¸ºå½“ promise settled æ—¶ <code>f</code> å°±ä¼šæ‰§è¡Œï¼šæ— è®º promise è¢« resolve è¿˜æ˜¯ rejectã€‚</p>
<p><code>finally</code> çš„åŠŸèƒ½æ˜¯è®¾ç½®ä¸€ä¸ªå¤„ç†ç¨‹åºåœ¨å‰é¢çš„æ“ä½œå®Œæˆåï¼Œæ‰§è¡Œæ¸…ç†&#x2F;ç»ˆç»“ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœæ­¢åŠ è½½æŒ‡ç¤ºå™¨ï¼Œå…³é—­ä¸å†éœ€è¦çš„è¿æ¥ç­‰ã€‚</p>
<p>æŠŠå®ƒæƒ³è±¡æˆæ´¾å¯¹çš„ç»ˆç»“è€…ã€‚æ— è®ºæ´¾å¯¹æ˜¯å¥½æ˜¯åï¼Œæœ‰å¤šå°‘æœ‹å‹å‚åŠ ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ï¼ˆæˆ–è€…è‡³å°‘åº”è¯¥ï¼‰åœ¨å®ƒä¹‹åè¿›è¡Œæ¸…ç†ã€‚</p>
<p>ä»£ç å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/* åšä¸€äº›éœ€è¦æ—¶é—´çš„äº‹ï¼Œä¹‹åè°ƒç”¨å¯èƒ½ä¼š resolve ä¹Ÿå¯èƒ½ä¼š reject */</span></span><br><span class="line">&#125;)</span><br><span class="line">*!*</span><br><span class="line">  <span class="comment">// åœ¨ promise ä¸º settled æ—¶è¿è¡Œï¼Œæ— è®ºæˆåŠŸä¸å¦</span></span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> stop loading indicator)</span><br><span class="line">  <span class="comment">// æ‰€ä»¥ï¼ŒåŠ è½½æŒ‡ç¤ºå™¨ï¼ˆloading indicatorï¼‰å§‹ç»ˆä¼šåœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰åœæ­¢</span></span><br><span class="line">*/!*</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> show result, <span class="function"><span class="params">err</span> =&gt;</span> show error)</span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼Œ<code>finally(f)</code> å¹¶ä¸å®Œå…¨æ˜¯ <code>then(f,f)</code> çš„åˆ«åã€‚</p>
<p>å®ƒä»¬ä¹‹é—´æœ‰é‡è¦çš„åŒºåˆ«ï¼š</p>
<ol>
<li><p><code>finally</code> å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰æ²¡æœ‰å‚æ•°ã€‚åœ¨ <code>finally</code> ä¸­ï¼Œæˆ‘ä»¬ä¸çŸ¥é“ promise æ˜¯å¦æˆåŠŸã€‚æ²¡å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬çš„ä»»åŠ¡é€šå¸¸æ˜¯æ‰§è¡Œâ€œå¸¸è§„â€çš„å®Œæˆç¨‹åºï¼ˆfinalizing proceduresï¼‰ã€‚</p>
<p> è¯·çœ‹ä¸Šé¢çš„ä¾‹å­ï¼šå¦‚ä½ æ‰€è§ï¼Œ<code>finally</code> å¤„ç†ç¨‹åºæ²¡æœ‰å‚æ•°ï¼Œpromise çš„ç»“æœç”±ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºå¤„ç†ã€‚</p>
</li>
<li><p><code>finally</code> å¤„ç†ç¨‹åºå°†ç»“æœæˆ– error â€œä¼ é€’â€ç»™ä¸‹ä¸€ä¸ªåˆé€‚çš„å¤„ç†ç¨‹åºã€‚</p>
<p> ä¾‹å¦‚ï¼Œåœ¨è¿™ç»“æœè¢«ä» <code>finally</code> ä¼ é€’ç»™äº† <code>then</code>ï¼š</p>
 <figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;value&quot;</span>), <span class="number">2000</span>)</span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;Promise ready&quot;</span>)) <span class="comment">// å…ˆè§¦å‘</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> <span class="title function_">alert</span>(result)); <span class="comment">// &lt;-- .then æ˜¾ç¤º &quot;value&quot;</span></span><br></pre></td></tr></table></figure>

<p> æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œç¬¬ä¸€ä¸ª promise è¿”å›çš„ <code>value</code> é€šè¿‡ <code>finally</code> è¢«ä¼ é€’ç»™äº†ä¸‹ä¸€ä¸ª <code>then</code>ã€‚</p>
<p> è¿™éå¸¸æ–¹ä¾¿ï¼Œå› ä¸º <code>finally</code> å¹¶ä¸æ„å‘³ç€å¤„ç†ä¸€ä¸ª promise çš„ç»“æœã€‚å¦‚å‰æ‰€è¿°ï¼Œæ— è®ºç»“æœæ˜¯ä»€ä¹ˆï¼Œå®ƒéƒ½æ˜¯è¿›è¡Œå¸¸è§„æ¸…ç†çš„åœ°æ–¹ã€‚</p>
<p> ä¸‹é¢æ˜¯ä¸€ä¸ª promise è¿”å›ç»“æœä¸º error çš„ç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•é€šè¿‡ <code>finally</code> è¢«ä¼ é€’ç»™ <code>catch</code> çš„ï¼š</p>
 <figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;Promise ready&quot;</span>)) <span class="comment">// å…ˆè§¦å‘</span></span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="title function_">alert</span>(err));  <span class="comment">// &lt;-- .catch æ˜¾ç¤ºè¿™ä¸ª error</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>finally</code> å¤„ç†ç¨‹åºä¹Ÿä¸åº”è¯¥è¿”å›ä»»ä½•å†…å®¹ã€‚å¦‚æœå®ƒè¿”å›äº†ï¼Œè¿”å›çš„å€¼ä¼šé»˜è®¤è¢«å¿½ç•¥ã€‚</p>
<p> æ­¤è§„åˆ™çš„å”¯ä¸€ä¾‹å¤–æ˜¯å½“ <code>finally</code> å¤„ç†ç¨‹åºæŠ›å‡º error æ—¶ã€‚æ­¤æ—¶è¿™ä¸ª errorï¼ˆè€Œä¸æ˜¯ä»»ä½•ä¹‹å‰çš„ç»“æœï¼‰ä¼šè¢«è½¬åˆ°ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚</p>
</li>
</ol>
<p>æ€»ç»“ï¼š</p>
<ul>
<li><code>finally</code> å¤„ç†ç¨‹åºæ²¡æœ‰å¾—åˆ°å‰ä¸€ä¸ªå¤„ç†ç¨‹åºçš„ç»“æœï¼ˆå®ƒæ²¡æœ‰å‚æ•°ï¼‰ã€‚è€Œè¿™ä¸ªç»“æœè¢«ä¼ é€’ç»™äº†ä¸‹ä¸€ä¸ªåˆé€‚çš„å¤„ç†ç¨‹åºã€‚</li>
<li>å¦‚æœ <code>finally</code> å¤„ç†ç¨‹åºè¿”å›äº†ä¸€äº›å†…å®¹ï¼Œé‚£ä¹ˆè¿™äº›å†…å®¹ä¼šè¢«å¿½ç•¥ã€‚</li>
<li>å½“ <code>finally</code> æŠ›å‡º error æ—¶ï¼Œæ‰§è¡Œå°†è½¬åˆ°æœ€è¿‘çš„ error çš„å¤„ç†ç¨‹åºã€‚</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬æ­£ç¡®ä½¿ç”¨ <code>finally</code>ï¼ˆå°†å…¶ç”¨äºå¸¸è§„æ¸…ç†ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›åŠŸèƒ½å°†å¾ˆæœ‰ç”¨ã€‚</p>
<figure class="highlight plaintext"><figcaption><span>header</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœ promise ä¸º pending çŠ¶æ€ï¼Œ`.then/catch/finally` å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰å°†ç­‰å¾…å®ƒçš„ç»“æœã€‚</span><br><span class="line"></span><br><span class="line">æœ‰æ—¶å€™ï¼Œå½“æˆ‘ä»¬å‘ä¸€ä¸ª promise æ·»åŠ å¤„ç†ç¨‹åºæ—¶ï¼Œå®ƒå¯èƒ½å·²ç» settled äº†ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™äº›å¤„ç†ç¨‹åºä¼šç«‹å³æ‰§è¡Œï¼š</span><br><span class="line"></span><br><span class="line">```js run</span><br><span class="line">// ä¸‹é¢è¿™ promise åœ¨è¢«åˆ›å»ºåç«‹å³å˜ä¸º resolved çŠ¶æ€</span><br><span class="line">let promise = new Promise(resolve =&gt; resolve(&quot;done!&quot;));</span><br><span class="line"></span><br><span class="line">promise.then(alert); // done!ï¼ˆç«‹åˆ»æ˜¾ç¤ºï¼‰</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">è¯·æ³¨æ„è¿™ä½¿å¾— promise æ¯”ç°å®ç”Ÿæ´»ä¸­çš„â€œè®¢é˜…åˆ—è¡¨â€æ–¹æ¡ˆå¼ºå¤§å¾—å¤šã€‚å¦‚æœæ­Œæ‰‹å·²ç»å‘å¸ƒäº†ä»–ä»¬çš„å•æ›²ï¼Œç„¶åæŸä¸ªäººåœ¨è®¢é˜…åˆ—è¡¨ä¸Šè¿›è¡Œäº†æ³¨å†Œï¼Œåˆ™ä»–ä»¬å¾ˆå¯èƒ½ä¸ä¼šæ”¶åˆ°è¯¥å•æ›²ã€‚å®é™…ç”Ÿæ´»ä¸­çš„è®¢é˜…å¿…é¡»åœ¨æ´»åŠ¨å¼€å§‹ä¹‹å‰è¿›è¡Œã€‚</span><br><span class="line"></span><br><span class="line">Promise åˆ™æ›´åŠ çµæ´»ã€‚æˆ‘ä»¬å¯ä»¥éšæ—¶æ·»åŠ å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰ï¼šå¦‚æœç»“æœå·²ç»åœ¨äº†ï¼Œå®ƒä»¬å°±ä¼šæ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure>

<h2 id="ç¤ºä¾‹ï¼šloadScript-loadscript"><a href="#ç¤ºä¾‹ï¼šloadScript-loadscript" class="headerlink" title="ç¤ºä¾‹ï¼šloadScript [#loadscript]"></a>ç¤ºä¾‹ï¼šloadScript [#loadscript]</h2><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å…³äº promise å¦‚ä½•å¸®åŠ©æˆ‘ä»¬ç¼–å†™å¼‚æ­¥ä»£ç çš„æ›´å¤šå®é™…ç¤ºä¾‹ã€‚</p>
<p>æˆ‘ä»¬ä»ä¸Šä¸€ç« è·å¾—äº†ç”¨äºåŠ è½½è„šæœ¬çš„ <code>loadScript</code> å‡½æ•°ã€‚</p>
<p>è¿™æ˜¯åŸºäºå›è°ƒå‡½æ•°çš„å˜ä½“ï¼Œè®°ä½å®ƒï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadScript</span>(<span class="params">src, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">  script.<span class="property">src</span> = src;</span><br><span class="line"></span><br><span class="line">  script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">callback</span>(<span class="literal">null</span>, script);</span><br><span class="line">  script.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Script load error for <span class="subst">$&#123;src&#125;</span>`</span>));</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">append</span>(script);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®©æˆ‘ä»¬ç”¨ promise é‡å†™å®ƒã€‚</p>
<p>æ–°å‡½æ•° <code>loadScript</code> å°†ä¸éœ€è¦å›è°ƒã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå®ƒå°†åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªåœ¨åŠ è½½å®Œæˆæ—¶ resolve çš„ promise å¯¹è±¡ã€‚å¤–éƒ¨ä»£ç å¯ä»¥ä½¿ç”¨ <code>.then</code> å‘å…¶æ·»åŠ å¤„ç†ç¨‹åºï¼ˆè®¢é˜…å‡½æ•°ï¼‰ï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadScript</span>(<span class="params">src</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    script.<span class="property">src</span> = src;</span><br><span class="line"></span><br><span class="line">    script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(script);</span><br><span class="line">    script.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Script load error for <span class="subst">$&#123;src&#125;</span>`</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">append</span>(script);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨æ³•ï¼š</p>
<figure class="highlight js"><figcaption><span>run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="title function_">loadScript</span>(<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.js&quot;</span>);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">script</span> =&gt;</span> <span class="title function_">alert</span>(<span class="string">`<span class="subst">$&#123;script.src&#125;</span> is loaded!`</span>),</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> <span class="title function_">alert</span>(<span class="string">`Error: <span class="subst">$&#123;error.message&#125;</span>`</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function"><span class="params">script</span> =&gt;</span> <span class="title function_">alert</span>(<span class="string">&#x27;Another handler...&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç«‹åˆ»å°±èƒ½å‘ç° promise ç›¸è¾ƒäºåŸºäºå›è°ƒçš„æ¨¡å¼çš„ä¸€äº›å¥½å¤„ï¼š</p>
<table>
<thead>
<tr>
<th>promise</th>
<th>callback</th>
</tr>
</thead>
<tbody><tr>
<td>promise å…è®¸æˆ‘ä»¬æŒ‰ç…§è‡ªç„¶é¡ºåºè¿›è¡Œç¼–ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¿è¡Œ <code>loadScript</code>ï¼Œä¹‹åï¼Œç”¨ <code>.then</code> æ¥å¤„ç†ç»“æœã€‚</td>
<td>åœ¨è°ƒç”¨ <code>loadScript(script, callback)</code> æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æœ‰ä¸€ä¸ª <code>callback</code> å‡½æ•°å¯ä¾›ä½¿ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨è°ƒç”¨ <code>loadScript</code> <strong>ä¹‹å‰</strong>ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“å¦‚ä½•å¤„ç†ç»“æœã€‚</td>
</tr>
<tr>
<td>æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦ï¼Œåœ¨ promise ä¸Šå¤šæ¬¡è°ƒç”¨ <code>.then</code>ã€‚æ¯æ¬¡è°ƒç”¨ï¼Œæˆ‘ä»¬éƒ½ä¼šåœ¨â€œè®¢é˜…åˆ—è¡¨â€ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„â€œç²‰ä¸â€ï¼Œä¸€ä¸ªæ–°çš„è®¢é˜…å‡½æ•°ã€‚åœ¨ä¸‹ä¸€ç« å°†å¯¹æ­¤å†…å®¹è¿›è¡Œè¯¦ç»†ä»‹ç»ï¼š<a href="info:promise-chaining"></a>ã€‚</td>
<td>åªèƒ½æœ‰ä¸€ä¸ªå›è°ƒã€‚</td>
</tr>
</tbody></table>
<p>å› æ­¤ï¼Œpromise ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¥½çš„ä»£ç æµå’Œçµæ´»æ€§ã€‚ä½†å…¶å®è¿˜æœ‰æ›´å¤šç›¸å…³å†…å®¹ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« çœ‹åˆ°ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://qhiqiefnqe-f.github.io">Hrein</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://qhiqiefnqe-f.github.io/2024/07/25/Diary/2024_7_25/">https://qhiqiefnqe-f.github.io/2024/07/25/Diary/2024_7_25/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://qhiqiefnqe-f.github.io" target="_blank">Hrein's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frontend/">frontend</a></div><div class="post_share"><div class="social-share" data-image="/assets/Hrein.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/24/Diary/2024_8_24/" title="ğŸ“•D2024_8_24"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ğŸ“•D2024_8_24</div></div></a></div><div class="next-post pull-right"><a href="/2024/06/29/Diary/2024_6_29/" title="ğŸ“•D2024_6_29"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ğŸ“•D2024_6_29</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2024/08/24/Diary/2024_8_24/" title="ğŸ“•D2024_8_24"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-24</div><div class="title">ğŸ“•D2024_8_24</div></div></a></div><div><a href="/2024/09/07/Diary/2024_9_7/" title="ğŸ“•D2024_9_7"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-07</div><div class="title">ğŸ“•D2024_9_7</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/assets/Hrein.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Hrein</div><div class="author-info__description">wuhu</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Promise"><span class="toc-number">1.</span> <span class="toc-text">Promise</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B6%88%E8%B4%B9%E8%80%85%EF%BC%9Athen%EF%BC%8Ccatch"><span class="toc-number">1.1.</span> <span class="toc-text">æ¶ˆè´¹è€…ï¼šthenï¼Œcatch</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#then"><span class="toc-number">1.1.1.</span> <span class="toc-text">then</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#catch"><span class="toc-number">1.1.2.</span> <span class="toc-text">catch</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%85%E7%90%86%EF%BC%9Afinally"><span class="toc-number">1.2.</span> <span class="toc-text">æ¸…ç†ï¼šfinally</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%EF%BC%9AloadScript-loadscript"><span class="toc-number">1.3.</span> <span class="toc-text">ç¤ºä¾‹ï¼šloadScript [#loadscript]</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/07/leetCodeNote/1.%E6%95%B0%E7%BB%84/" title="ğŸš·æ•°ç»„">ğŸš·æ•°ç»„</a><time datetime="2024-09-07T06:28:29.000Z" title="å‘è¡¨äº 2024-09-07 14:28:29">2024-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/07/leetCodeNote/3.%E5%93%88%E5%B8%8C%E8%A1%A8/" title="ğŸš·å“ˆå¸Œè¡¨">ğŸš·å“ˆå¸Œè¡¨</a><time datetime="2024-09-07T06:28:29.000Z" title="å‘è¡¨äº 2024-09-07 14:28:29">2024-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/07/leetCodeNote/4.%E5%AD%97%E7%AC%A6%E4%B8%B2/" title="ğŸš·å­—ç¬¦ä¸²">ğŸš·å­—ç¬¦ä¸²</a><time datetime="2024-09-07T06:28:29.000Z" title="å‘è¡¨äº 2024-09-07 14:28:29">2024-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/07/leetCodeNote/2.%E9%93%BE%E8%A1%A8/" title="ğŸš·é“¾è¡¨">ğŸš·é“¾è¡¨</a><time datetime="2024-09-07T06:28:29.000Z" title="å‘è¡¨äº 2024-09-07 14:28:29">2024-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/07/leetCodeNote/5.%E5%8F%8C%E6%8C%87%E9%92%88/" title="ğŸš·åŒæŒ‡é’ˆ">ğŸš·åŒæŒ‡é’ˆ</a><time datetime="2024-09-07T06:28:29.000Z" title="å‘è¡¨äº 2024-09-07 14:28:29">2024-09-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Hrein</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>